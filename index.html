<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard Electoral - Impacto de Reformas</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans:wght@400;500;600;700&family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    <script src="script.js"></script>
</head>
<body>
    <div class="root">
        <!-- Header -->
        <div class="header-section">
            <div class="header-content">
                <div class="header-title">Reforma Electoral</div>
            </div>
            <div class="header-date">Fecha de corte: 18-08-2025</div>
        </div>

        <!-- Layout Container -->
        <div class="layout-container">
            <!-- Mobile Menu Button -->
            <button class="mobile-menu-btn" id="mobile-menu-btn" aria-label="Abrir panel de control">
                <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                    <path d="M3 5h14M3 10h14M3 15h14" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                </svg>
            </button>
            
            <!-- Control Sidebar -->
            <div class="control-sidebar" id="control-sidebar">
                <div class="sidebar-header">
                    <h3 class="sidebar-title">Panel de Control</h3>
                    <button class="sidebar-toggle" id="sidebar-toggle" aria-label="Contraer panel">
                        <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                            <path d="M3 7h10l-3-3m0 6l3-3"/>
                        </svg>
                    </button>
                </div>
                
                <div class="sidebar-content">
                    <!-- Step 0: Configuración Maestra -->
                    <div class="control-group master-controls" data-group="master">
                        <button class="group-toggle" data-target="master" data-tooltip="Configuración Base">
                            <span class="group-title">Configuración Base</span>
                            <svg class="chevron" width="12" height="12" viewBox="0 0 12 12">
                                <path d="M4 2l4 4-4 4" stroke="currentColor" stroke-width="1.5" fill="none"/>
                            </svg>
                        </button>
                        <div class="group-content" id="group-master">
                            <!-- Cámara -->
                            <div class="control-item">
                                <label class="control-label">Cámara</label>
                                <div class="master-toggle-group" role="tablist">
                                    <button class="master-toggle" data-chamber="diputados" role="tab">
                                        <span class="toggle-text">Diputados</span>
                                        <span class="toggle-count">500</span>
                                    </button>
                                    <button class="master-toggle active" data-chamber="senadores" role="tab">
                                        <span class="toggle-text">Senadores</span>
                                        <span class="toggle-count">128</span>
                                    </button>
                                </div>
                            </div>
                            
                            <!-- Año -->
                            <div class="control-item">
                                <label class="control-label">Año Electoral</label>
                                <div class="master-pills" role="radiogroup">
                                    <button class="master-pill active" data-year="2018">2018</button>
                                    <button class="master-pill" data-year="2021">2021</button>
                                    <button class="master-pill" data-year="2024">2024</button>
                                </div>
                            </div>
                            
                            <!-- Modelo -->
                            <div class="control-item">
                                <label class="control-label">Modelo de Simulación</label>
                                <div class="master-pills" role="radiogroup">
                                    <button class="master-pill" data-model="vigente">Vigente</button>
                                    <button class="master-pill" data-model="plan-a">Plan A</button>
                                    <button class="master-pill" data-model="plan-c">Plan C</button>
                                    <button class="master-pill active" data-model="personalizado">Personalizado</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Step 1: Shocks de Votación -->
                    <div class="control-group" data-group="shocks">
                        <button class="group-toggle" data-target="shocks" data-tooltip="Shocks por Partido">
                            <span class="group-title">Shocks por partido (Δ porcentaje)</span>
                            <svg class="chevron" width="12" height="12" viewBox="0 0 12 12">
                                <path d="M4 2l4 4-4 4" stroke="currentColor" stroke-width="1.5" fill="none"/>
                            </svg>
                        </button>
                        <div class="group-content" id="group-shocks">
                            <div class="control-item">
                                <div class="party-shock-inputs">
                                    <div class="shock-input-group">
                                        <div class="shock-value-box" id="shock-value-morena">+0.0%</div>
                                        <label class="shock-label" for="shock-morena">MORENA</label>
                                        <input type="range" class="shock-slider" id="shock-morena" min="-20" max="20" step="0.1" value="0">
                                    </div>
                                    <div class="shock-input-group">
                                        <div class="shock-value-box" id="shock-value-pan">+0.0%</div>
                                        <label class="shock-label" for="shock-pan">PAN</label>
                                        <input type="range" class="shock-slider" id="shock-pan" min="-20" max="20" step="0.1" value="0">
                                    </div>
                                    <div class="shock-input-group">
                                        <div class="shock-value-box" id="shock-value-pri">+0.0%</div>
                                        <label class="shock-label" for="shock-pri">PRI</label>
                                        <input type="range" class="shock-slider" id="shock-pri" min="-20" max="20" step="0.1" value="0">
                                    </div>
                                    <div class="shock-input-group">
                                        <div class="shock-value-box" id="shock-value-pt">+0.0%</div>
                                        <label class="shock-label" for="shock-pt">PT</label>
                                        <input type="range" class="shock-slider" id="shock-pt" min="-20" max="20" step="0.1" value="0">
                                    </div>
                                    <div class="shock-input-group">
                                        <div class="shock-value-box" id="shock-value-pvem">+0.0%</div>
                                        <label class="shock-label" for="shock-pvem">PVEM</label>
                                        <input type="range" class="shock-slider" id="shock-pvem" min="-20" max="20" step="0.1" value="0">
                                    </div>
                                    <div class="shock-input-group">
                                        <div class="shock-value-box" id="shock-value-mc">+0.0%</div>
                                        <label class="shock-label" for="shock-mc">MC</label>
                                        <input type="range" class="shock-slider" id="shock-mc" min="-20" max="20" step="0.1" value="0">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Step 2: Magnitud -->
                    <div class="control-group" data-group="magnitude">
                        <button class="group-toggle" data-target="magnitude" data-tooltip="Total de Cámara">
                            <span class="group-title">Magnitud de cámara</span>
                            <svg class="chevron" width="12" height="12" viewBox="0 0 12 12">
                                <path d="M4 2l4 4-4 4" stroke="currentColor" stroke-width="1.5" fill="none"/>
                            </svg>
                        </button>
                        <div class="group-content" id="group-magnitude">
                            <div class="control-item">
                                <label class="control-label">Total de escaños: <span id="input-magnitud-value">128</span></label>
                                <input type="range" class="control-slider" id="input-magnitud" min="1" max="700" step="1" value="128">
                            </div>
                        </div>
                    </div>

                    <!-- Step 3: Umbral -->
                    <div class="control-group" data-group="threshold">
                        <button class="group-toggle" data-target="threshold" data-tooltip="Configuración del Umbral">
                            <span class="group-title">Configuración del umbral</span>
                            <svg class="chevron" width="12" height="12" viewBox="0 0 12 12">
                                <path d="M4 2l4 4-4 4" stroke="currentColor" stroke-width="1.5" fill="none"/>
                            </svg>
                        </button>
                        <div class="group-content" id="group-threshold">
                            <div class="control-item">
                                <label class="control-label">¿Activar umbral?</label>
                                <div class="toggle-switch">
                                    <div class="switch active" id="threshold-switch" data-switch="On" role="switch" aria-checked="true">
                                        <div class="switch-handle"></div>
                                    </div>
                                </div>
                            </div>
                            <div class="control-item">
                                <div class="radio-options">
                                    <div class="radio-option" data-state="On" id="radio-national">
                                        <div class="radio-button">
                                            <div class="radio-dot"></div>
                                        </div>
                                        <div class="radio-text">
                                            <div class="radio-label">Nacional (%)</div>
                                        </div>
                                    </div>
                                    <div class="radio-option" data-state="Off" id="radio-state">
                                        <div class="radio-button"></div>
                                        <div class="radio-text">
                                            <div class="radio-label">Estatal (%)</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="control-item">
                                <div class="threshold-controls">
                                    <div class="threshold-value-box" id="threshold-value-box">3.0%</div>
                                    <label class="control-label">Porcentaje mínimo:</label>
                                    <input type="range" class="control-slider threshold-slider" id="threshold-slider" min="0" max="20" step="0.1" value="3">
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Step 4: Cláusula de Sobrerrepresentación -->
                    <div class="control-group deputy-only" data-group="overrepresentation" id="overrepresentation-group" style="display:none;">
                        <button class="group-toggle" data-target="overrepresentation" data-tooltip="Límite de Sobrerrepresentación">
                            <span class="group-title">Límite de sobrerrepresentación</span>
                            <svg class="chevron" width="12" height="12" viewBox="0 0 12 12">
                                <path d="M4 2l4 4-4 4" stroke="currentColor" stroke-width="1.5" fill="none"/>
                            </svg>
                        </button>
                        <div class="group-content" id="group-overrepresentation">
                            <div class="control-item">
                                <div class="overrep-value-box" id="overrep-value-box">8.0%</div>
                                <label class="control-label">Límite sobre % voto nacional:</label>
                                <input type="range" class="control-slider overrep-slider" id="overrep-slider" min="0" max="20" step="0.1" value="8">
                            </div>
                        </div>
                    </div>

                    <!-- Step 4.1: Tope de Escaños por Partido -->
                    <div class="control-group deputy-only" data-group="seat-cap" id="seat-cap-group" style="display:none;">
                        <button class="group-toggle" data-target="seat-cap" data-tooltip="Tope de Escaños por Partido">
                            <span class="group-title"> Tope de escaños por partido</span>
                            <svg class="chevron" width="12" height="12" viewBox="0 0 12 12">
                                <path d="M4 2l4 4-4 4" stroke="currentColor" stroke-width="1.5" fill="none"/>
                            </svg>
                        </button>
                        <div class="group-content" id="group-seat-cap">
                            <div class="control-item">
                                <label class="control-label">¿Limitar máximo de escaños por partido?</label>
                                <div class="toggle-switch">
                                    <div class="switch" id="seat-cap-switch" data-switch="Off" role="switch" aria-checked="false">
                                        <div class="switch-handle"></div>
                                    </div>
                                </div>
                            </div>
                            <div class="control-item" id="seat-cap-input-group" style="display:none;">
                                <label class="control-label">Máximo de escaños por partido: <span id="seat-cap-input-value">300</span></label>
                                <input type="range" class="control-slider" id="seat-cap-input" min="1" max="500" step="1" value="300">
                                <div class="parameter-note">Si un partido supera el tope, los escaños excedentes se redistribuyen por RP.</div>
                            </div>
                        </div>
                    </div>

                    <!-- Step 5: Coaliciones -->
                    <div class="control-group" data-group="coalition">
                        <button class="group-toggle" data-target="coalition" data-tooltip="Coaliciones">
                            <span class="group-title">Coaliciones</span>
                            <svg class="chevron" width="12" height="12" viewBox="0 0 12 12">
                                <path d="M4 2l4 4-4 4" stroke="currentColor" stroke-width="1.5" fill="none"/>
                            </svg>
                        </button>
                        <div class="group-content" id="group-coalition">
                            <div class="control-item">
                                <div class="toggle-switch">
                                    <div class="switch active" id="coalition-switch" data-switch="On" role="switch" aria-checked="true">
                                        <div class="switch-handle"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Step 6: Regla Electoral -->
                    <div class="control-group" data-group="rules">
                        <button class="group-toggle" data-target="rules" data-tooltip="Tipo de Regla">
                            <span class="group-title">Regla electoral</span>
                            <svg class="chevron" width="12" height="12" viewBox="0 0 12 12">
                                <path d="M4 2l4 4-4 4" stroke="currentColor" stroke-width="1.5" fill="none"/>
                            </svg>
                        </button>
                        <div class="group-content" id="group-rules">
                            <div class="control-item">
                                <div class="radio-options">
                                    <div class="radio-option" data-state="Off" id="radio-mr">
                                        <div class="radio-button"></div>
                                        <div class="radio-text">
                                            <div class="radio-label">Mayoría Relativa</div>
                                        </div>
                                    </div>
                                    <div class="radio-option" data-state="Off" id="radio-rp">
                                        <div class="radio-button"></div>
                                        <div class="radio-text">
                                            <div class="radio-label">Representación Proporcional</div>
                                        </div>
                                    </div>
                                    <div class="radio-option" data-state="On" id="radio-mixto">
                                        <div class="radio-button">
                                            <div class="radio-dot"></div>
                                        </div>
                                        <div class="radio-text">
                                            <div class="radio-label">Mixto</div>
                                            <div class="radio-sublabel">Mayoría Relativa + Representación Proporcional</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="control-item mixto-inputs" id="mixto-inputs">
                                <div class="dual-slider">
                                    <div class="slider-group">
                                        <label class="slider-label">MR <span id="input-mr-value">64</span></label>
                                        <input type="range" class="control-slider" id="input-mr" min="0" max="700" step="1" value="64">
                                    </div>
                                    <div class="slider-group">
                                        <label class="slider-label">RP <span id="input-rp-value">64</span></label>
                                        <input type="range" class="control-slider" id="input-rp" min="0" max="700" step="1" value="64">
                                    </div>
                                </div>
                                <div class="validation-message hidden" id="mixto-validation">
                                    La suma de escaños debe ser igual al total de la cámara
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Step 6.1: Primera Minoría -->
                    <div class="control-group" data-group="first-minority" id="first-minority-group" style="display:none;">
                        <button class="group-toggle" data-target="first-minority" data-tooltip="Primera Minoría">
                            <span class="group-title">Primera minoría</span>
                            <svg class="chevron" width="12" height="12" viewBox="0 0 12 12">
                                <path d="M4 2l4 4-4 4" stroke="currentColor" stroke-width="1.5" fill="none"/>
                            </svg>
                        </button>
                        <div class="group-content" id="group-first-minority">
                            <div class="control-item">
                                <label class="control-label">¿Activar primera minoría?</label>
                                <div class="toggle-switch">
                                    <div class="switch active" id="first-minority-switch" data-switch="On" role="switch" aria-checked="true">
                                        <div class="switch-handle"></div>
                                    </div>
                                </div>
                            </div>
                            <div class="control-item">
                                <label class="control-label">Escaños por primera minoría: <span id="input-first-minority-value">0</span></label>
                                <input type="range" class="control-slider" id="input-first-minority" min="0" max="700" step="1" value="0">
                            </div>
                        </div>
                    </div>

                    <!-- Step 7: Método de Reparto -->
                    <div class="control-group" data-group="method">
                        <button class="group-toggle" data-target="method" data-tooltip="Método de Asignación">
                            <span class="group-title">Método de asignación</span>
                            <svg class="chevron" width="12" height="12" viewBox="0 0 12 12">
                                <path d="M4 2l4 4-4 4" stroke="currentColor" stroke-width="1.5" fill="none"/>
                            </svg>
                        </button>
                        <div class="group-content" id="group-method">
                            <div class="control-item">
                                <label class="control-label">Cociente + restos:</label>
                                <select class="control-select" id="quota-method">
                                    <option value="hare" selected>Hare</option>
                                    <option value="droop">Droop</option>
                                </select>
                            </div>
                            <div class="control-item">
                                <label class="control-label">Divisores:</label>
                                <select class="control-select" id="divisor-method">
                                    <option value="dhondt" selected>D'Hondt</option>
                                    <option value="sainte-lague">Sainte-Laguë</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Mobile Sidebar Overlay -->
            <div class="sidebar-overlay" id="sidebar-overlay"></div>

            <!-- Main Content Area -->
            <div class="main-content">
                <!-- Dashboard Header with KPIs -->
                <div class="dashboard-header">
                    <div class="title-section">
                        <div class="main-title">Herramienta de Simulación Electoral</div>
                    </div>
                    <div class="subtitle-section">
                    <div class="indicadores-resumen">
                            <indicador-box etiqueta="Total de escaños" valor="128" style="--fondo:#fff;"></indicador-box>
                            <indicador-box etiqueta="% votos vs % escaños" valor="±2.1%" style="--fondo:#fff;"></indicador-box>
                            <indicador-box etiqueta="Índice de Gallagher" valor="5.2" style="--fondo:#fff;"></indicador-box>
                            <indicador-box etiqueta="Totales del Sistema" valor="60.1M" style="--fondo:#fff;"></indicador-box>
                            <indicador-box etiqueta="Umbral de inclusión" valor="3%" style="--fondo:#fff;"></indicador-box>
                            <indicador-box etiqueta="Umbral de representación" valor="8pp" style="--fondo:#fff;"></indicador-box>
                        </div>
                    </div>
                </div>

                <!-- Chamber Composition -->
                <div class="chamber-composition">
                    <div class="composition-title">Composición de la Cámara de Senadores</div>
                    <div class="composition-container">
                        <div class="composition-content">
                            <div class="seat-map" role="img" aria-label="Distribución de escaños en la Cámara de Senadores">
                                <div class="seat-grid">
                                    <!-- Las filas se generarán dinámicamente con JavaScript -->
                                </div>
                            </div>
                            
                            <div class="results-panel">
                                <div class="results-title">Resultados por partido</div>
                                <div class="party-results">
                                    <div class="party-result">
                                        <div class="party-color" style="background: #8B2231;"></div>
                                        <div class="party-name">MORENA</div>
                                        <div class="party-stats">
                                            <div class="party-seats">69 escaños</div>
                                            <div class="party-percentage">53.9%</div>
                                        </div>
                                    </div>
                                    <div class="party-result">
                                        <div class="party-color" style="background: #0055A5;"></div>
                                        <div class="party-name">PAN</div>
                                        <div class="party-stats">
                                            <div class="party-seats">22 escaños</div>
                                            <div class="party-percentage">17.2%</div>
                                        </div>
                                    </div>
                                    <div class="party-result">
                                        <div class="party-color" style="background: #0D7137;"></div>
                                        <div class="party-name">PRI</div>
                                        <div class="party-stats">
                                            <div class="party-seats">16 escaños</div>
                                            <div class="party-percentage">12.5%</div>
                                        </div>
                                    </div>
                                    <div class="party-result">
                                        <div class="party-color" style="background: #D52B1E;"></div>
                                        <div class="party-name">PT</div>
                                        <div class="party-stats">
                                            <div class="party-seats">8 escaños</div>
                                            <div class="party-percentage">6.3%</div>
                                        </div>
                                    </div>
                                    <div class="party-result">
                                        <div class="party-color" style="background: #5CE23D;"></div>
                                        <div class="party-name">PVEM</div>
                                        <div class="party-stats">
                                            <div class="party-seats">6 escaños</div>
                                            <div class="party-percentage">4.7%</div>
                                        </div>
                                    </div>
                                    <div class="party-result">
                                        <div class="party-color" style="background: #F58025;"></div>
                                        <div class="party-name">MC</div>
                                        <div class="party-stats">
                                            <div class="party-seats">4 escaños</div>
                                            <div class="party-percentage">3.1%</div>
                                        </div>
                                    </div>
                                    <div class="party-result">
                                        <div class="party-color" style="background: #FFCC00;"></div>
                                        <div class="party-name">PRD</div>
                                        <div class="party-stats">
                                            <div class="party-seats">3 escaños</div>
                                            <div class="party-percentage">2.3%</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div> <!-- End layout-container -->
    </div>
    <script>
    // Web Component para KPI reutilizable
    class IndicadorBox extends HTMLElement {
      static get observedAttributes() {
        return ['etiqueta', 'color', 'valor', 'porcentaje', 'cantidad', 'promedio'];
      }
      connectedCallback() { this.render(); }
      attributeChangedCallback() { this.render(); }
      render() {
        const etiqueta = this.getAttribute('etiqueta') || '';
        const valor = this.getAttribute('valor') || '';
        // const porcentaje = this.getAttribute('porcentaje') || '';
        // const cantidad = this.getAttribute('cantidad') || '';
        // Clase para fondo: neutro siempre
        const fondoClase = 'fondo-verde';
        // const clase = porcentaje.toString().trim().startsWith('-') ? 'negativo' : 'positivo';
        this.innerHTML = `
          <div class="etiqueta">${etiqueta}</div>
          <div class="valor">${valor}</div>
        `;
      }
    }
    customElements.define('indicador-box', IndicadorBox);
    </script>
</body>
</html>
